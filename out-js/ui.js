'use strict';
onerror = alert;
navigator.geolocation.getCurrentPosition(function (pos) { return init(pos.coords.latitude, pos.coords.longitude); }, function () { return init(25.116035, 121.529946); } // fallback to TAS
);
function init(lat, lng) {
    var qs = document.querySelector.bind(document);
    var introScreen = qs('#intro-screen');
    var queryButton = qs('#query-button');
    var queryingScreen = qs('#querying-screen');
    var queryState = qs('#query-state');
    var chooseScreen = qs('#choose-screen');
    var nodesCreatedElem = qs('#nodes-created');
    var startNodeIdElem = qs('#start-node-id');
    var goalNodeIdElem = qs('#goal-node-id');
    var searchButton = qs('#search-button');
    var resultsScreen = qs('#results-screen');
    var searchProgress = qs('#search-progress');
    var searchState = qs('#search-state');
    var map = L.map('map', {
        center: [lat, lng],
        zoom: 17,
        minZoom: 12
    });
    L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',
        maxZoom: 21,
        maxNativeZoom: 19
    }).addTo(map);
    showElem(introScreen);
    queryButton.addEventListener('click', function () {
        hideElem(introScreen);
        showElem(queryingScreen);
        queryState.textContent = 'Querying Overpass API...';
        var bounds = map.getBounds();
        var query = "\n            [out:json];\n            way [highway] (\n                " + bounds.getSouth() + ",\n                " + bounds.getWest() + ",\n                " + bounds.getNorth() + ",\n                " + bounds.getEast() + "\n            );\n            out geom;\n        ";
        fetch('https://overpass-api.de/api/interpreter?data=' + query)
            .then(function (res) { return res.json(); })
            .then(function (data) {
            queryState.textContent = 'Creating nodes...';
            var nodes = overpassToGraphNodes(data);
            var startNode = null;
            var goalNode = null;
            var searchFunction;
            var defaultCircleStyle = {
                radius: 6,
                stroke: false,
                fillOpacity: 0.7
            };
            var nodeIdToCircle = new Map();
            var _loop_1 = function(node) {
                nodeIdToCircle.set(node.id, L.circle(node, defaultCircleStyle).bindPopup(function (circle) {
                    var elem = document.createElement('div');
                    var id = document.createElement('div');
                    id.textContent = node.id.toString();
                    elem.appendChild(id);
                    var startLink = document.createElement('a');
                    startLink.href = '#';
                    startLink.textContent = 'Set as start';
                    startLink.addEventListener('click', function () {
                        if (node === goalNode) {
                            goalNode = null;
                            goalNodeIdElem.textContent = '';
                            nodeIdToCircle.get(node.id)
                                .setStyle(defaultCircleStyle);
                        }
                        if (startNode !== null) {
                            nodeIdToCircle.get(startNode.id)
                                .setStyle(defaultCircleStyle);
                        }
                        startNode = node;
                        startNodeIdElem.textContent = startNode.id.toString();
                        checkSearchButton();
                        circle.closePopup();
                        circle.setStyle(Object.assign({
                            color: 'red'
                        }, defaultCircleStyle));
                    });
                    elem.appendChild(startLink);
                    elem.appendChild(document.createElement('br'));
                    var goalLink = document.createElement('a');
                    goalLink.href = '#';
                    goalLink.textContent = 'Set as goal';
                    goalLink.addEventListener('click', function () {
                        if (node === startNode) {
                            startNode = null;
                            startNodeIdElem.textContent = '';
                            nodeIdToCircle.get(node.id)
                                .setStyle(defaultCircleStyle);
                        }
                        if (goalNode) {
                            nodeIdToCircle.get(goalNode.id)
                                .setStyle(defaultCircleStyle);
                        }
                        goalNode = node;
                        goalNodeIdElem.textContent = goalNode.id.toString();
                        checkSearchButton();
                        circle.closePopup();
                        circle.setStyle(Object.assign({
                            color: 'green'
                        }, defaultCircleStyle));
                    });
                    elem.appendChild(goalLink);
                    return elem;
                }).addTo(map));
            };
            for (var _i = 0, nodes_1 = nodes; _i < nodes_1.length; _i++) {
                var node = nodes_1[_i];
                _loop_1(node);
            }
            var radioToFunction = {
                'uniform-cost-radio': uniformCostSearch,
                'greedy-radio': greedySearch,
                'a-star-radio': aStarSearch
            };
            var _loop_2 = function(id) {
                document.querySelector('#' + id).addEventListener('click', function () {
                    searchFunction = radioToFunction[id];
                    checkSearchButton();
                });
            };
            for (var id in radioToFunction) {
                _loop_2(id);
            }
            nodesCreatedElem.textContent = nodes.length.toString();
            queryState.textContent = '';
            hideElem(queryingScreen);
            showElem(chooseScreen);
            function checkSearchButton() {
                searchButton.disabled = !(startNode && goalNode && searchFunction);
            }
            searchButton.addEventListener('click', function () {
                hideElem(chooseScreen);
                showElem(resultsScreen);
                searchProgress.classList.add('mdl-progress__indeterminate');
                searchState.textContent = 'Searching...';
                var res = searchFunction(startNode, goalNode);
                searchProgress.classList.remove('mdl-progress__indeterminate');
                if (res === null) {
                    searchState.textContent = 'Path not found';
                }
                else {
                    searchState.textContent = "Path found, " + res.expanded.length + " nodes expanded, path is " + res.path.length + " nodes long";
                    for (var _i = 0, _a = res.expanded; _i < _a.length; _i++) {
                        var expanded = _a[_i];
                        nodeIdToCircle.get(expanded.id)
                            .setStyle(Object.assign({
                            color: 'darkblue'
                        }, defaultCircleStyle));
                    }
                    L.polyline(res.path, {
                        weight: 8,
                        color: 'darkblue'
                    }).addTo(map);
                    console.log(res);
                }
            });
        });
    });
    function showElem(elem) {
        elem.style.display = 'block';
    }
    function hideElem(elem) {
        elem.style.display = 'none';
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidWkuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMtdHMvdWkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWSxDQUFDO0FBRWIsT0FBTyxHQUFHLEtBQUssQ0FBQztBQUVoQixTQUFTLENBQUMsV0FBVyxDQUFDLGtCQUFrQixDQUNwQyxVQUFBLEdBQUcsSUFBSSxPQUFBLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxHQUFHLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxFQUEvQyxDQUErQyxFQUN0RCxjQUFNLE9BQUEsSUFBSSxDQUFDLFNBQVMsRUFBRSxVQUFVLENBQUMsRUFBM0IsQ0FBMkIsQ0FBQyxrQkFBa0I7Q0FDdkQsQ0FBQztBQUVGLGNBQWMsR0FBVyxFQUFFLEdBQVc7SUFDbEMsSUFBTSxFQUFFLEdBQWtDLFFBQVEsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ2hGLElBQU0sV0FBVyxHQUFHLEVBQUUsQ0FBQyxlQUFlLENBQWdCLENBQUM7SUFDdkQsSUFBTSxXQUFXLEdBQUcsRUFBRSxDQUFDLGVBQWUsQ0FBQyxDQUFDO0lBQ3hDLElBQU0sY0FBYyxHQUFHLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBZ0IsQ0FBQztJQUM3RCxJQUFNLFVBQVUsR0FBRyxFQUFFLENBQUMsY0FBYyxDQUFDLENBQUM7SUFDdEMsSUFBTSxZQUFZLEdBQUcsRUFBRSxDQUFDLGdCQUFnQixDQUFnQixDQUFDO0lBQ3pELElBQU0sZ0JBQWdCLEdBQUcsRUFBRSxDQUFDLGdCQUFnQixDQUFDLENBQUM7SUFDOUMsSUFBTSxlQUFlLEdBQUcsRUFBRSxDQUFDLGdCQUFnQixDQUFDLENBQUM7SUFDN0MsSUFBTSxjQUFjLEdBQUcsRUFBRSxDQUFDLGVBQWUsQ0FBQyxDQUFDO0lBQzNDLElBQU0sWUFBWSxHQUFHLEVBQUUsQ0FBQyxnQkFBZ0IsQ0FBc0IsQ0FBQztJQUMvRCxJQUFNLGFBQWEsR0FB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LGlDQUE0QixHQUFHLENBQUMsSUFBSSxDQUFDLE1BQU0sZ0JBQWEsQ0FBQztvQkFDckgsR0FBRyxDQUFDLENBQW1CLFVBQVksRUFBWixLQUFBLEdBQUcsQ0FBQyxRQUFRLEVBQVosY0FBWSxFQUFaLElBQVksQ0FBQzt3QkFBL0IsSUFBTSxRQUFRLFNBQUE7d0JBQ2QsY0FBYyxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFjOzZCQUM1QyxRQUFRLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQzs0QkFDcEIsS0FBSyxFQUFFLFVBQVU7eUJBQ3BCLEVBQUUsa0JBQWtCLENBQUMsQ0FBQyxDQUFDO3FCQUMzQjtvQkFDRCxDQUFDLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUU7d0JBQ2pCLE1BQU0sRUFBRSxDQUFDO3dCQUNULEtBQUssRUFBRSxVQUFVO3FCQUNwQixDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO29CQUNkLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7Z0JBQ3JCLENBQUM7WUFDTCxDQUFDLENBQUMsQ0FBQztRQUNQLENBQUMsQ0FBQyxDQUFDO0lBQ1gsQ0FBQyxDQUFDLENBQUM7SUFDSCxrQkFBa0IsSUFBaUI7UUFDL0IsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDO0lBQ2pDLENBQUM7SUFDRCxrQkFBa0IsSUFBaUI7UUFDL0IsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDO0lBQ2hDLENBQUM7QUFDTCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xyXG5cclxub25lcnJvciA9IGFsZXJ0O1xyXG5cclxubmF2aWdhdG9yLmdlb2xvY2F0aW9uLmdldEN1cnJlbnRQb3NpdGlvbihcclxuICAgIHBvcyA9PiBpbml0KHBvcy5jb29yZHMubGF0aXR1ZGUsIHBvcy5jb29yZHMubG9uZ2l0dWRlKSxcclxuICAgICgpID0+IGluaXQoMjUuMTE2MDM1LCAxMjEuNTI5OTQ2KSAvLyBmYWxsYmFjayB0byBUQVNcclxuKTtcclxuXHJcbmZ1bmN0aW9uIGluaXQobGF0OiBudW1iZXIsIGxuZzogbnVtYmVyKSB7XHJcbiAgICBjb25zdCBxczogdHlwZW9mIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yLmJpbmQoZG9jdW1lbnQpO1xyXG4gICAgY29uc3QgaW50cm9TY3JlZW4gPSBxcygnI2ludHJvLXNjcmVlbicpIGFzIEhUTUxFbGVtZW50O1xyXG4gICAgY29uc3QgcXVlcnlCdXR0b24gPSBxcygnI3F1ZXJ5LWJ1dHRvbicpO1xyXG4gICAgY29uc3QgcXVlcnlpbmdTY3JlZW4gPSBxcygnI3F1ZXJ5aW5nLXNjcmVlbicpIGFzIEhUTUxFbGVtZW50O1xyXG4gICAgY29uc3QgcXVlcnlTdGF0ZSA9IHFzKCcjcXVlcnktc3RhdGUnKTtcclxuICAgIGNvbnN0IGNob29zZVNjcmVlbiA9IHFzKCcjY2hvb3NlLXNjcmVlbicpIGFzIEhUTUxFbGVtZW50O1xyXG4gICAgY29uc3Qgbm9kZXNDcmVhdGVkRWxlbSA9IHFzKCcjbm9kZXMtY3JlYXRlZCcpO1xyXG4gICAgY29uc3Qgc3RhcnROb2RlSWRFbGVtID0gcXMoJyNzdGFydC1ub2RlLWlkJyk7XHJcbiAgICBjb25zdCBnb2FsTm9kZUlkRWxlbSA9IHFzKCcjZ29hbC1ub2RlLWlkJyk7XHJcbiAgICBjb25zdCBzZWFyY2hCdXR0b24gPSBxcygnI3NlYXJjaC1idXR0b24nKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcclxuICAgIGNvbnN0IHJlc3VsdHNTY3JlZW4gPSBxcygnI3Jlc3VsdHMtc2NyZWVuJykgYXMgSFRNTEVsZW1lbnQ7XHJcbiAgICBjb25zdCBzZWFyY2hQcm9ncmVzcyA9IHFzKCcjc2VhcmNoLXByb2dyZXNzJyk7XHJcbiAgICBjb25zdCBzZWFyY2hTdGF0ZSA9IHFzKCcjc2VhcmNoLXN0YXRlJyk7XHJcbiAgICBjb25zdCBtYXAgPSBMLm1hcCgnbWFwJywge1xyXG4gICAgICAgIGNlbnRlcjogW2xhdCwgbG5nXSxcclxuICAgICAgICB6b29tOiAxNyxcclxuICAgICAgICBtaW5ab29tOiAxMlxyXG4gICAgfSk7XHJcbiAgICBMLnRpbGVMYXllcignaHR0cDovL3tzfS50aWxlLm9zbS5vcmcve3p9L3t4fS97eX0ucG5nJywge1xyXG4gICAgICAgIGF0dHJpYnV0aW9uOiAnJmNvcHk7IDxhIGhyZWY9XCJodHRwOi8vb3NtLm9yZy9jb3B5cmlnaHRcIj5PcGVuU3RyZWV0TWFwPC9hPiBjb250cmlidXRvcnMnLFxyXG4gICAgICAgIG1heFpvb206IDIxLFxyXG4gICAgICAgIG1heE5hdGl2ZVpvb206IDE5XHJcbiAgICB9KS5hZGRUbyhtYXApO1xyXG4gICAgc2hvd0VsZW0oaW50cm9TY3JlZW4pO1xyXG4gICAgcXVlcnlCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgaGlkZUVsZW0oaW50cm9TY3JlZW4pO1xyXG4gICAgICAgIHNob3dFbGVtKHF1ZXJ5aW5nU2NyZWVuKTtcclxuICAgICAgICBxdWVyeVN0YXRlLnRleHRDb250ZW50ID0gJ1F1ZXJ5aW5nIE92ZXJwYXNzIEFQSS4uLic7XHJcbiAgICAgICAgY29uc3QgYm91bmRzID0gbWFwLmdldEJvdW5kcygpO1xyXG4gICAgICAgIGNvbnN0IHF1ZXJ5ID0gYFxyXG4gICAgICAgICAgICBbb3V0Ompzb25dO1xyXG4gICAgICAgICAgICB3YXkgW2hpZ2h3YXldIChcclxuICAgICAgICAgICAgICAgICR7Ym91bmRzLmdldFNvdXRoKCl9LFxyXG4gICAgICAgICAgICAgICAgJHtib3VuZHMuZ2V0V2VzdCgpfSxcclxuICAgICAgICAgICAgICAgICR7Ym91bmRzLmdldE5vcnRoKCl9LFxyXG4gICAgICAgICAgICAgICAgJHtib3VuZHMuZ2V0RWFzdCgpfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBvdXQgZ2VvbTtcclxuICAgICAgICBgO1xyXG4gICAgICAgIGZldGNoKCdodHRwczovL292ZXJwYXNzLWFwaS5kZS9hcGkvaW50ZXJwcmV0ZXI/ZGF0YT0nICsgcXVlcnkpXHJcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PiByZXMuanNvbigpKVxyXG4gICAgICAgICAgICAudGhlbigoZGF0YTogT3ZlcnBhc3NKU09OKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBxdWVyeVN0YXRlLnRleHRDb250ZW50ID0gJ0NyZWF0aW5nIG5vZGVzLi4uJztcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVzID0gb3ZlcnBhc3NUb0dyYXBoTm9kZXMoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICBsZXQgc3RhcnROb2RlOiBHcmFwaE5vZGUgfCBudWxsID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGxldCBnb2FsTm9kZTogR3JhcGhOb2RlIHwgbnVsbCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBsZXQgc2VhcmNoRnVuY3Rpb246IFNlYXJjaEZ1bmN0aW9uO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZGVmYXVsdENpcmNsZVN0eWxlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJhZGl1czogNixcclxuICAgICAgICAgICAgICAgICAgICBzdHJva2U6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGZpbGxPcGFjaXR5OiAwLjdcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBjb25zdCBub2RlSWRUb0NpcmNsZSA9IG5ldyBNYXA8bnVtYmVyLCBMLkNpcmNsZT4oKTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBub2Rlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGVJZFRvQ2lyY2xlLnNldChub2RlLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBMLmNpcmNsZShub2RlLCBkZWZhdWx0Q2lyY2xlU3R5bGUpLmJpbmRQb3B1cChjaXJjbGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaWQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkLnRleHRDb250ZW50ID0gbm9kZS5pZC50b1N0cmluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbS5hcHBlbmRDaGlsZChpZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydExpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydExpbmsuaHJlZiA9ICcjJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TGluay50ZXh0Q29udGVudCA9ICdTZXQgYXMgc3RhcnQnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRMaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlID09PSBnb2FsTm9kZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb2FsTm9kZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvYWxOb2RlSWRFbGVtLnRleHRDb250ZW50ID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChub2RlSWRUb0NpcmNsZS5nZXQobm9kZS5pZCkgYXMgTC5DaXJjbGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0U3R5bGUoZGVmYXVsdENpcmNsZVN0eWxlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXJ0Tm9kZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAobm9kZUlkVG9DaXJjbGUuZ2V0KHN0YXJ0Tm9kZS5pZCkgYXMgTC5DaXJjbGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0U3R5bGUoZGVmYXVsdENpcmNsZVN0eWxlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnROb2RlID0gbm9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydE5vZGVJZEVsZW0udGV4dENvbnRlbnQgPSBzdGFydE5vZGUuaWQudG9TdHJpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja1NlYXJjaEJ1dHRvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNpcmNsZS5jbG9zZVBvcHVwKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGNpcmNsZSBhcyBMLkNpcmNsZSkuc2V0U3R5bGUoT2JqZWN0LmFzc2lnbih7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAncmVkJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGRlZmF1bHRDaXJjbGVTdHlsZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtLmFwcGVuZENoaWxkKHN0YXJ0TGluayk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2JyJykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZ29hbExpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb2FsTGluay5ocmVmID0gJyMnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ29hbExpbmsudGV4dENvbnRlbnQgPSAnU2V0IGFzIGdvYWwnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ29hbExpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUgPT09IHN0YXJ0Tm9kZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydE5vZGUgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydE5vZGVJZEVsZW0udGV4dENvbnRlbnQgPSAnJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKG5vZGVJZFRvQ2lyY2xlLmdldChub2RlLmlkKSBhcyBMLkNpcmNsZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRTdHlsZShkZWZhdWx0Q2lyY2xlU3R5bGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ29hbE5vZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKG5vZGVJZFRvQ2lyY2xlLmdldChnb2FsTm9kZS5pZCkgYXMgTC5DaXJjbGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0U3R5bGUoZGVmYXVsdENpcmNsZVN0eWxlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ29hbE5vZGUgPSBub2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvYWxOb2RlSWRFbGVtLnRleHRDb250ZW50ID0gZ29hbE5vZGUuaWQudG9TdHJpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja1NlYXJjaEJ1dHRvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNpcmNsZS5jbG9zZVBvcHVwKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGNpcmNsZSBhcyBMLkNpcmNsZSkuc2V0U3R5bGUoT2JqZWN0LmFzc2lnbih7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnZ3JlZW4nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZGVmYXVsdENpcmNsZVN0eWxlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW0uYXBwZW5kQ2hpbGQoZ29hbExpbmspO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsZW07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmFkZFRvKG1hcCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgcmFkaW9Ub0Z1bmN0aW9uOiB7IFtpZDogc3RyaW5nXTogU2VhcmNoRnVuY3Rpb24gfSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAndW5pZm9ybS1jb3N0LXJhZGlvJzogdW5pZm9ybUNvc3RTZWFyY2gsXHJcbiAgICAgICAgICAgICAgICAgICAgJ2dyZWVkeS1yYWRpbyc6IGdyZWVkeVNlYXJjaCxcclxuICAgICAgICAgICAgICAgICAgICAnYS1zdGFyLXJhZGlvJzogYVN0YXJTZWFyY2hcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGlkIGluIHJhZGlvVG9GdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgaWQpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2hGdW5jdGlvbiA9IHJhZGlvVG9GdW5jdGlvbltpZF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrU2VhcmNoQnV0dG9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBub2Rlc0NyZWF0ZWRFbGVtLnRleHRDb250ZW50ID0gbm9kZXMubGVuZ3RoLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgICAgICAgICBxdWVyeVN0YXRlLnRleHRDb250ZW50ID0gJyc7XHJcbiAgICAgICAgICAgICAgICBoaWRlRWxlbShxdWVyeWluZ1NjcmVlbik7XHJcbiAgICAgICAgICAgICAgICBzaG93RWxlbShjaG9vc2VTY3JlZW4pO1xyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2tTZWFyY2hCdXR0b24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoQnV0dG9uLmRpc2FibGVkID0gIShzdGFydE5vZGUgJiYgZ29hbE5vZGUgJiYgc2VhcmNoRnVuY3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc2VhcmNoQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGhpZGVFbGVtKGNob29zZVNjcmVlbik7XHJcbiAgICAgICAgICAgICAgICAgICAgc2hvd0VsZW0ocmVzdWx0c1NjcmVlbik7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoUHJvZ3Jlc3MuY2xhc3NMaXN0LmFkZCgnbWRsLXByb2dyZXNzX19pbmRldGVybWluYXRlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoU3RhdGUudGV4dENvbnRlbnQgPSAnU2VhcmNoaW5nLi4uJztcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXMgPSBzZWFyY2hGdW5jdGlvbihzdGFydE5vZGUgYXMgR3JhcGhOb2RlLCBnb2FsTm9kZSBhcyBHcmFwaE5vZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlYXJjaFByb2dyZXNzLmNsYXNzTGlzdC5yZW1vdmUoJ21kbC1wcm9ncmVzc19faW5kZXRlcm1pbmF0ZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXMgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoU3RhdGUudGV4dENvbnRlbnQgPSAnUGF0aCBub3QgZm91bmQnO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlYXJjaFN0YXRlLnRleHRDb250ZW50ID0gYFBhdGggZm91bmQsICR7cmVzLmV4cGFuZGVkLmxlbmd0aH0gbm9kZXMgZXhwYW5kZWQsIHBhdGggaXMgJHtyZXMucGF0aC5sZW5ndGh9IG5vZGVzIGxvbmdgO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGV4cGFuZGVkIG9mIHJlcy5leHBhbmRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKG5vZGVJZFRvQ2lyY2xlLmdldChleHBhbmRlZC5pZCkgYXMgTC5DaXJjbGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0U3R5bGUoT2JqZWN0LmFzc2lnbih7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdkYXJrYmx1ZSdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGRlZmF1bHRDaXJjbGVTdHlsZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEwucG9seWxpbmUocmVzLnBhdGgsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdlaWdodDogOCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnZGFya2JsdWUnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmFkZFRvKG1hcCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICBmdW5jdGlvbiBzaG93RWxlbShlbGVtOiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgIGVsZW0uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBoaWRlRWxlbShlbGVtOiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgIGVsZW0uc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgIH1cclxufSJdfQ==