'use strict';
onerror = alert;
navigator.geolocation.getCurrentPosition(function (pos) { return init(pos.coords.latitude, pos.coords.longitude); }, function () { return init(25.116035, 121.529946); } // fallback to TAS
);
function init(lat, lng) {
    var qs = document.querySelector.bind(document);
    var introScreen = qs('#intro-screen');
    var queryButton = qs('#query-button');
    var queryingScreen = qs('#querying-screen');
    var queryState = qs('#query-state');
    var chooseScreen = qs('#choose-screen');
    var startNodeIdElem = qs('#start-node-id');
    var goalNodeIdElem = qs('#goal-node-id');
    var searchButton = qs('#search-button');
    var resultsScreen = qs('#results-screen');
    var searchProgress = qs('#search-progress');
    var searchState = qs('#search-state');
    var map = L.map('map', {
        center: [lat, lng],
        zoom: 17,
        minZoom: 12
    });
    L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',
        maxZoom: 21,
        maxNativeZoom: 19
    }).addTo(map);
    showElem(introScreen);
    queryButton.addEventListener('click', function () {
        hideElem(introScreen);
        showElem(queryingScreen);
        queryState.textContent = 'Querying Overpass API...';
        var bounds = map.getBounds();
        var query = "\n            [out:json];\n            way [highway] (\n                " + bounds.getSouth() + ",\n                " + bounds.getWest() + ",\n                " + bounds.getNorth() + ",\n                " + bounds.getEast() + "\n            );\n            out geom;\n        ";
        fetch('https://overpass-api.de/api/interpreter?data=' + query)
            .then(function (res) { return res.json(); })
            .then(function (data) {
            queryState.textContent = 'Creating nodes...';
            var nodes = overpassToGraphNodes(data);
            var startNode = null;
            var goalNode = null;
            var searchFunction;
            var defaultCircleStyle = {
                radius: 6,
                stroke: false,
                fillOpacity: 0.7
            };
            var nodeIdToCircle = new Map();
            var _loop_1 = function(node) {
                nodeIdToCircle.set(node.id, L.circle(node, defaultCircleStyle).bindPopup(function (circle) {
                    var elem = document.createElement('div');
                    var id = document.createElement('div');
                    id.textContent = node.id.toString();
                    elem.appendChild(id);
                    var startLink = document.createElement('a');
                    startLink.href = '#';
                    startLink.textContent = 'Set as start';
                    startLink.addEventListener('click', function () {
                        if (node === goalNode) {
                            goalNode = null;
                            goalNodeIdElem.textContent = '';
                            nodeIdToCircle.get(node.id)
                                .setStyle(defaultCircleStyle);
                        }
                        if (startNode !== null) {
                            nodeIdToCircle.get(startNode.id)
                                .setStyle(defaultCircleStyle);
                        }
                        startNode = node;
                        startNodeIdElem.textContent = startNode.id.toString();
                        checkSearchButton();
                        circle.closePopup();
                        circle.setStyle(Object.assign({
                            color: 'red'
                        }, defaultCircleStyle));
                    });
                    elem.appendChild(startLink);
                    elem.appendChild(document.createElement('br'));
                    var goalLink = document.createElement('a');
                    goalLink.href = '#';
                    goalLink.textContent = 'Set as goal';
                    goalLink.addEventListener('click', function () {
                        if (node === startNode) {
                            startNode = null;
                            startNodeIdElem.textContent = '';
                            nodeIdToCircle.get(node.id)
                                .setStyle(defaultCircleStyle);
                        }
                        if (goalNode) {
                            nodeIdToCircle.get(goalNode.id)
                                .setStyle(defaultCircleStyle);
                        }
                        goalNode = node;
                        goalNodeIdElem.textContent = goalNode.id.toString();
                        checkSearchButton();
                        circle.closePopup();
                        circle.setStyle(Object.assign({
                            color: 'green'
                        }, defaultCircleStyle));
                    });
                    elem.appendChild(goalLink);
                    return elem;
                }).addTo(map));
            };
            for (var _i = 0, nodes_1 = nodes; _i < nodes_1.length; _i++) {
                var node = nodes_1[_i];
                _loop_1(node);
            }
            var radioToFunction = {
                'uniform-cost-radio': uniformCostSearch,
                'greedy-radio': greedySearch,
                'a-star-radio': aStarSearch
            };
            var _loop_2 = function(id) {
                document.querySelector('#' + id).addEventListener('click', function () {
                    searchFunction = radioToFunction[id];
                    checkSearchButton();
                });
            };
            for (var id in radioToFunction) {
                _loop_2(id);
            }
            queryState.textContent = '';
            hideElem(queryingScreen);
            showElem(chooseScreen);
            console.log(nodes.length + ' nodes created');
            function checkSearchButton() {
                searchButton.disabled = !(startNode && goalNode && searchFunction);
            }
            searchButton.addEventListener('click', function () {
                hideElem(chooseScreen);
                showElem(resultsScreen);
                searchProgress.classList.add('mdl-progress__indeterminate');
                searchState.textContent = 'Searching...';
                var res = searchFunction(startNode, goalNode);
                searchProgress.classList.remove('mdl-progress__indeterminate');
                if (res === null) {
                    searchState.textContent = 'Path not found';
                }
                else {
                    searchState.textContent = "Path found, " + res.expanded.length + " nodes expanded, path is " + res.path.length + " nodes long";
                    for (var _i = 0, _a = res.expanded; _i < _a.length; _i++) {
                        var expanded = _a[_i];
                        nodeIdToCircle.get(expanded.id)
                            .setStyle(Object.assign({
                            color: 'darkblue'
                        }, defaultCircleStyle));
                    }
                    L.polyline(res.path, {
                        weight: 8,
                        color: 'darkblue'
                    }).addTo(map);
                    console.log(res);
                }
            });
        });
    });
    function showElem(elem) {
        elem.style.display = 'block';
    }
    function hideElem(elem) {
        elem.style.display = 'none';
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidWkuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMtdHMvdWkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWSxDQUFDO0FBRWIsT0FBTyxHQUFHLEtBQUssQ0FBQztBQUVoQixTQUFTLENBQUMsV0FBVyxDQUFDLGtCQUFrQixDQUNwQyxVQUFBLEdBQUcsSUFBSSxPQUFBLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxHQUFHLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxFQUEvQyxDQUErQyxFQUN0RCxjQUFNLE9BQUEsSUFBSSxDQUFDLFNBQVMsRUFBRSxVQUFVLENBQUMsRUFBM0IsQ0FBMkIsQ0FBQyxrQkFBa0I7Q0FDdkQsQ0FBQztBQUVGLGNBQWMsR0FBVyxFQUFFLEdBQVc7SUFDbEMsSUFBTSxFQUFFLEdBQWtDLFFBQVEsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ2hGLElBQU0sV0FBVyxHQUFHLEVBQUUsQ0FBQyxlQUFlLENBQWdCLENBQUM7SUFDdkQsSUFBTSxXQUFXLEdBQUcsRUFBRSxDQUFDLGVBQWUsQ0FBQyxDQUFDO0lBQ3hDLElBQU0sY0FBYyxHQUFHLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBZ0IsQ0FBQztJQUM3RCxJQUFNLFVBQVUsR0FBRyxFQUFFLENBQUMsY0FBYyxDQUFDLENBQUM7SUFDdEMsSUFBTSxZQUFZLEdBQUcsRUFBRSxDQUFDLGdCQUFnQixDQUFnQixDQUFDO0lBQ3pELElBQU0sZUFBZSxHQUFHLEVBQUUsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0lBQzdDLElBQU0sY0FBYyxHQUFHLEVBQUUsQ0FBQyxlQUFlLENBQUMsQ0FBQztJQUMzQyxJQUFNLFlBQVksR0FBRyxFQUFFLENBQUMsZ0JBQWdCLENBQXNCLENBQUM7SUFDL0QsSUFBTSxhQUFhLEdBQUcsRUFBRSxDQUFDLGlCQUFpQixDQUFnQixDQUFDO0lBQzNELElBQU0sY0FBYyxHQUFH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LEdBQUcsQ0FBQyxDQUFtQixVQUFZLEVBQVosS0FBQSxHQUFHLENBQUMsUUFBUSxFQUFaLGNBQVksRUFBWixJQUFZLENBQUM7d0JBQS9CLElBQU0sUUFBUSxTQUFBO3dCQUNkLGNBQWMsQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBYzs2QkFDNUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUM7NEJBQ3BCLEtBQUssRUFBRSxVQUFVO3lCQUNwQixFQUFFLGtCQUFrQixDQUFDLENBQUMsQ0FBQTtxQkFDMUI7b0JBQ0QsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFO3dCQUNqQixNQUFNLEVBQUUsQ0FBQzt3QkFDVCxLQUFLLEVBQUUsVUFBVTtxQkFDcEIsQ0FBQyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztvQkFDZCxPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUNyQixDQUFDO1lBQ0wsQ0FBQyxDQUFDLENBQUM7UUFDUCxDQUFDLENBQUMsQ0FBQztJQUNYLENBQUMsQ0FBQyxDQUFDO0lBQ0gsa0JBQWtCLElBQWlCO1FBQy9CLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztJQUNqQyxDQUFDO0lBQ0Qsa0JBQWtCLElBQWlCO1FBQy9CLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxHQUFHLE1BQU0sQ0FBQztJQUNoQyxDQUFDO0FBQ0wsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcclxuXHJcbm9uZXJyb3IgPSBhbGVydDtcclxuXHJcbm5hdmlnYXRvci5nZW9sb2NhdGlvbi5nZXRDdXJyZW50UG9zaXRpb24oXHJcbiAgICBwb3MgPT4gaW5pdChwb3MuY29vcmRzLmxhdGl0dWRlLCBwb3MuY29vcmRzLmxvbmdpdHVkZSksXHJcbiAgICAoKSA9PiBpbml0KDI1LjExNjAzNSwgMTIxLjUyOTk0NikgLy8gZmFsbGJhY2sgdG8gVEFTXHJcbik7XHJcblxyXG5mdW5jdGlvbiBpbml0KGxhdDogbnVtYmVyLCBsbmc6IG51bWJlcikge1xyXG4gICAgY29uc3QgcXM6IHR5cGVvZiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvci5iaW5kKGRvY3VtZW50KTtcclxuICAgIGNvbnN0IGludHJvU2NyZWVuID0gcXMoJyNpbnRyby1zY3JlZW4nKSBhcyBIVE1MRWxlbWVudDtcclxuICAgIGNvbnN0IHF1ZXJ5QnV0dG9uID0gcXMoJyNxdWVyeS1idXR0b24nKTtcclxuICAgIGNvbnN0IHF1ZXJ5aW5nU2NyZWVuID0gcXMoJyNxdWVyeWluZy1zY3JlZW4nKSBhcyBIVE1MRWxlbWVudDtcclxuICAgIGNvbnN0IHF1ZXJ5U3RhdGUgPSBxcygnI3F1ZXJ5LXN0YXRlJyk7XHJcbiAgICBjb25zdCBjaG9vc2VTY3JlZW4gPSBxcygnI2Nob29zZS1zY3JlZW4nKSBhcyBIVE1MRWxlbWVudDtcclxuICAgIGNvbnN0IHN0YXJ0Tm9kZUlkRWxlbSA9IHFzKCcjc3RhcnQtbm9kZS1pZCcpO1xyXG4gICAgY29uc3QgZ29hbE5vZGVJZEVsZW0gPSBxcygnI2dvYWwtbm9kZS1pZCcpO1xyXG4gICAgY29uc3Qgc2VhcmNoQnV0dG9uID0gcXMoJyNzZWFyY2gtYnV0dG9uJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XHJcbiAgICBjb25zdCByZXN1bHRzU2NyZWVuID0gcXMoJyNyZXN1bHRzLXNjcmVlbicpIGFzIEhUTUxFbGVtZW50O1xyXG4gICAgY29uc3Qgc2VhcmNoUHJvZ3Jlc3MgPSBxcygnI3NlYXJjaC1wcm9ncmVzcycpO1xyXG4gICAgY29uc3Qgc2VhcmNoU3RhdGUgPSBxcygnI3NlYXJjaC1zdGF0ZScpO1xyXG4gICAgY29uc3QgbWFwID0gTC5tYXAoJ21hcCcsIHtcclxuICAgICAgICBjZW50ZXI6IFtsYXQsIGxuZ10sXHJcbiAgICAgICAgem9vbTogMTcsXHJcbiAgICAgICAgbWluWm9vbTogMTJcclxuICAgIH0pO1xyXG4gICAgTC50aWxlTGF5ZXIoJ2h0dHA6Ly97c30udGlsZS5vc20ub3JnL3t6fS97eH0ve3l9LnBuZycsIHtcclxuICAgICAgICBhdHRyaWJ1dGlvbjogJyZjb3B5OyA8YSBocmVmPVwiaHR0cDovL29zbS5vcmcvY29weXJpZ2h0XCI+T3BlblN0cmVldE1hcDwvYT4gY29udHJpYnV0b3JzJyxcclxuICAgICAgICBtYXhab29tOiAyMSxcclxuICAgICAgICBtYXhOYXRpdmVab29tOiAxOVxyXG4gICAgfSkuYWRkVG8obWFwKTtcclxuICAgIHNob3dFbGVtKGludHJvU2NyZWVuKTtcclxuICAgIHF1ZXJ5QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgIGhpZGVFbGVtKGludHJvU2NyZWVuKTtcclxuICAgICAgICBzaG93RWxlbShxdWVyeWluZ1NjcmVlbik7XHJcbiAgICAgICAgcXVlcnlTdGF0ZS50ZXh0Q29udGVudCA9ICdRdWVyeWluZyBPdmVycGFzcyBBUEkuLi4nO1xyXG4gICAgICAgIGNvbnN0IGJvdW5kcyA9IG1hcC5nZXRCb3VuZHMoKTtcclxuICAgICAgICBjb25zdCBxdWVyeSA9IGBcclxuICAgICAgICAgICAgW291dDpqc29uXTtcclxuICAgICAgICAgICAgd2F5IFtoaWdod2F5XSAoXHJcbiAgICAgICAgICAgICAgICAke2JvdW5kcy5nZXRTb3V0aCgpfSxcclxuICAgICAgICAgICAgICAgICR7Ym91bmRzLmdldFdlc3QoKX0sXHJcbiAgICAgICAgICAgICAgICAke2JvdW5kcy5nZXROb3J0aCgpfSxcclxuICAgICAgICAgICAgICAgICR7Ym91bmRzLmdldEVhc3QoKX1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgb3V0IGdlb207XHJcbiAgICAgICAgYDtcclxuICAgICAgICBmZXRjaCgnaHR0cHM6Ly9vdmVycGFzcy1hcGkuZGUvYXBpL2ludGVycHJldGVyP2RhdGE9JyArIHF1ZXJ5KVxyXG4gICAgICAgICAgICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSlcclxuICAgICAgICAgICAgLnRoZW4oKGRhdGE6IE92ZXJwYXNzSlNPTikgPT4ge1xyXG4gICAgICAgICAgICAgICAgcXVlcnlTdGF0ZS50ZXh0Q29udGVudCA9ICdDcmVhdGluZyBub2Rlcy4uLic7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBub2RlcyA9IG92ZXJwYXNzVG9HcmFwaE5vZGVzKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgbGV0IHN0YXJ0Tm9kZTogR3JhcGhOb2RlIHwgbnVsbCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBsZXQgZ29hbE5vZGU6IEdyYXBoTm9kZSB8IG51bGwgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgbGV0IHNlYXJjaEZ1bmN0aW9uOiBTZWFyY2hGdW5jdGlvbjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGRlZmF1bHRDaXJjbGVTdHlsZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICByYWRpdXM6IDYsXHJcbiAgICAgICAgICAgICAgICAgICAgc3Ryb2tlOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICBmaWxsT3BhY2l0eTogMC43XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgbm9kZUlkVG9DaXJjbGUgPSBuZXcgTWFwPG51bWJlciwgTC5DaXJjbGU+KCk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygbm9kZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBub2RlSWRUb0NpcmNsZS5zZXQobm9kZS5pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgTC5jaXJjbGUobm9kZSwgZGVmYXVsdENpcmNsZVN0eWxlKS5iaW5kUG9wdXAoY2lyY2xlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVsZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZC50ZXh0Q29udGVudCA9IG5vZGUuaWQudG9TdHJpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW0uYXBwZW5kQ2hpbGQoaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhcnRMaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRMaW5rLmhyZWYgPSAnIyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydExpbmsudGV4dENvbnRlbnQgPSAnU2V0IGFzIHN0YXJ0JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TGluay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZSA9PT0gZ29hbE5vZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ29hbE5vZGUgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb2FsTm9kZUlkRWxlbS50ZXh0Q29udGVudCA9ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAobm9kZUlkVG9DaXJjbGUuZ2V0KG5vZGUuaWQpIGFzIEwuQ2lyY2xlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNldFN0eWxlKGRlZmF1bHRDaXJjbGVTdHlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGFydE5vZGUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKG5vZGVJZFRvQ2lyY2xlLmdldChzdGFydE5vZGUuaWQpIGFzIEwuQ2lyY2xlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNldFN0eWxlKGRlZmF1bHRDaXJjbGVTdHlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0Tm9kZSA9IG5vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnROb2RlSWRFbGVtLnRleHRDb250ZW50ID0gc3RhcnROb2RlLmlkLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tTZWFyY2hCdXR0b24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaXJjbGUuY2xvc2VQb3B1cCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjaXJjbGUgYXMgTC5DaXJjbGUpLnNldFN0eWxlKE9iamVjdC5hc3NpZ24oe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJ3JlZCdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBkZWZhdWx0Q2lyY2xlU3R5bGUpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbS5hcHBlbmRDaGlsZChzdGFydExpbmspO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdicicpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGdvYWxMaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ29hbExpbmsuaHJlZiA9ICcjJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvYWxMaW5rLnRleHRDb250ZW50ID0gJ1NldCBhcyBnb2FsJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvYWxMaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlID09PSBzdGFydE5vZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnROb2RlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnROb2RlSWRFbGVtLnRleHRDb250ZW50ID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChub2RlSWRUb0NpcmNsZS5nZXQobm9kZS5pZCkgYXMgTC5DaXJjbGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0U3R5bGUoZGVmYXVsdENpcmNsZVN0eWxlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdvYWxOb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChub2RlSWRUb0NpcmNsZS5nZXQoZ29hbE5vZGUuaWQpIGFzIEwuQ2lyY2xlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNldFN0eWxlKGRlZmF1bHRDaXJjbGVTdHlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvYWxOb2RlID0gbm9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb2FsTm9kZUlkRWxlbS50ZXh0Q29udGVudCA9IGdvYWxOb2RlLmlkLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tTZWFyY2hCdXR0b24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaXJjbGUuY2xvc2VQb3B1cCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjaXJjbGUgYXMgTC5DaXJjbGUpLnNldFN0eWxlKE9iamVjdC5hc3NpZ24oe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJ2dyZWVuJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGRlZmF1bHRDaXJjbGVTdHlsZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtLmFwcGVuZENoaWxkKGdvYWxMaW5rKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlbGVtO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5hZGRUbyhtYXApKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHJhZGlvVG9GdW5jdGlvbjogeyBbaWQ6IHN0cmluZ106IFNlYXJjaEZ1bmN0aW9uIH0gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJ3VuaWZvcm0tY29zdC1yYWRpbyc6IHVuaWZvcm1Db3N0U2VhcmNoLFxyXG4gICAgICAgICAgICAgICAgICAgICdncmVlZHktcmFkaW8nOiBncmVlZHlTZWFyY2gsXHJcbiAgICAgICAgICAgICAgICAgICAgJ2Etc3Rhci1yYWRpbyc6IGFTdGFyU2VhcmNoXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBpZCBpbiByYWRpb1RvRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIGlkKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoRnVuY3Rpb24gPSByYWRpb1RvRnVuY3Rpb25baWRdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVja1NlYXJjaEJ1dHRvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcXVlcnlTdGF0ZS50ZXh0Q29udGVudCA9ICcnO1xyXG4gICAgICAgICAgICAgICAgaGlkZUVsZW0ocXVlcnlpbmdTY3JlZW4pO1xyXG4gICAgICAgICAgICAgICAgc2hvd0VsZW0oY2hvb3NlU2NyZWVuKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG5vZGVzLmxlbmd0aCArICcgbm9kZXMgY3JlYXRlZCcpO1xyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2tTZWFyY2hCdXR0b24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoQnV0dG9uLmRpc2FibGVkID0gIShzdGFydE5vZGUgJiYgZ29hbE5vZGUgJiYgc2VhcmNoRnVuY3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc2VhcmNoQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGhpZGVFbGVtKGNob29zZVNjcmVlbik7XHJcbiAgICAgICAgICAgICAgICAgICAgc2hvd0VsZW0ocmVzdWx0c1NjcmVlbik7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoUHJvZ3Jlc3MuY2xhc3NMaXN0LmFkZCgnbWRsLXByb2dyZXNzX19pbmRldGVybWluYXRlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoU3RhdGUudGV4dENvbnRlbnQgPSAnU2VhcmNoaW5nLi4uJztcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXMgPSBzZWFyY2hGdW5jdGlvbihzdGFydE5vZGUgYXMgR3JhcGhOb2RlLCBnb2FsTm9kZSBhcyBHcmFwaE5vZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlYXJjaFByb2dyZXNzLmNsYXNzTGlzdC5yZW1vdmUoJ21kbC1wcm9ncmVzc19faW5kZXRlcm1pbmF0ZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXMgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoU3RhdGUudGV4dENvbnRlbnQgPSAnUGF0aCBub3QgZm91bmQnO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlYXJjaFN0YXRlLnRleHRDb250ZW50ID0gYFBhdGggZm91bmQsICR7cmVzLmV4cGFuZGVkLmxlbmd0aH0gbm9kZXMgZXhwYW5kZWQsIHBhdGggaXMgJHtyZXMucGF0aC5sZW5ndGh9IG5vZGVzIGxvbmdgO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGV4cGFuZGVkIG9mIHJlcy5leHBhbmRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKG5vZGVJZFRvQ2lyY2xlLmdldChleHBhbmRlZC5pZCkgYXMgTC5DaXJjbGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0U3R5bGUoT2JqZWN0LmFzc2lnbih7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdkYXJrYmx1ZSdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGRlZmF1bHRDaXJjbGVTdHlsZSkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgTC5wb2x5bGluZShyZXMucGF0aCwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0OiA4LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdkYXJrYmx1ZSdcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSkuYWRkVG8obWFwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIGZ1bmN0aW9uIHNob3dFbGVtKGVsZW06IEhUTUxFbGVtZW50KSB7XHJcbiAgICAgICAgZWxlbS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGhpZGVFbGVtKGVsZW06IEhUTUxFbGVtZW50KSB7XHJcbiAgICAgICAgZWxlbS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgfVxyXG59Il19